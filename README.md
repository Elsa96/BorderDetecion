# BorderDetecion  

## 检测
- 思路一  
1. 中值滤波去噪；  
2. 依次提取不同的颜色通道（BGR）检测矩形；  
3. 对每一通道使用canny检测边缘或者使用多个阈值二值化；  
4. 使用findContours函数查找轮廓；  
5. 使用approxPolyDP函数去除多边形轮廓一些小的波折；  
6. 找到同时满足面积较大和形状为凸的四边形；  
7. 判断轮廓中两两邻接直线夹角余弦是否小于0.3（意味着角度在90度附近），是则此四边形为找到的矩形。  
- 思路二（本项目使用）：  


## 检测只露出三条边的车筐
- 思路一：  
1. 求出四个交点  
2. 若有两个交点x,y之间的距离同时小于300（此参数视情况而定），则改用另一个函数  
3. 取画面边界中的一条作为第四条边（如何？）  
- 思路二：
1. 霍夫直线变换后，判断画面中有几条边  
1.1 求出所有直线的k值，k值相近的为一条直线  
2. 再选取画面边界的其中一条作为第四条边（如何？）  
- 思路三(*)：  
1. 求出所有交点的相交次数，按从大到小排序  
2. 若第一个点的次数大于第三个点的四倍，则判定只有三条直线，取最大的两个交点（某点次数明显大于其余点的程序怎么写）  
3. 若两个交点的y值相近，则取上边界或下边界为第四条直线；若x值相近，则取左或右边界（注意此时斜率为无穷，所以不应该取垂直直线，稍微有一点斜率）  
4. 求得另四个交点，根据坐标在原图上取像素，若为黄色则为最终交点  
- 思路四：
1. 加上跟踪算法  

## 检测只有两条边的车筐
- 两种情况  
1. 有1个交点  
2. 没有交点（两条线平行）  
对于2，区分只有1条边的情况：若取画面边界以后，只产生2个交点，则原图只有1条边；若产生4个交点，则有2条边。  
### 1个交点
1. 求出所有交点的相交次数，按从大到小排序  
2. 若第一个点的次数大于第二个点的四倍，则判定只有2条直线  
3. 取上下左右边界为第三、四条直线，求出九个最大的交点  
4. 根据坐标在原图上取像素，若为黄色则保留交点  
- 情况一：与边界的交点分别在两条不同的直线上  
5. 根据保留的交点判断分别在哪两条边界上，最终确定第四个交点（四个角中的一个）  
- 情况二：与边界的交点在同一条直线上  
5. 取边界交点所在的直线，连接这三个点  
### 没有交点（两条线平行）
1. 取上下左右边界为第三、四条直线  
2. 求出四个交点  
3. 判断：若第一个点的相交次数大于第三个点的四倍，则原图只有一条直线，反之，是最终正确的四个交点  

